<!DOCTYPE html>
<html>

<head>
  <title>Picker API Quickstart</title>
  <meta charset="utf-8" />
</head>

<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"
    integrity="sha512-r22gChDnGvBylk90+2e/ycr3RVrDi8DIOkIGNhJlKfuyQM4tIRAI062MaV8sfjQKYVGjOBaZBOA87z+IhZE9DA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://js.live.net/v7.2/OneDrive.js"></script>
    
  <!-- <script src="https://github.com/wilkenstein/redis-mock-min.js"></script> -->

  <p>Import data  </p>

  <!--Add buttons to initiate auth sequence and sign out-->
  <button id="authorize_button" onclick="handleAuthClick()">Sign In with Google</button>
  <button id="signout_button" onclick="handleSignoutClick()">Sign Out</button>

  <script type="text/javascript">
    function launchOneDrivePicker(){
      var odOptions = {
        clientId:"d4adf40d-6298-4b6c-ace9-806c5e170b15",
        action: "query",
        multiSelect: true,
        advanced: {},
        success: function(files) { /* success handler */
        
          console.log(files)
        },
        cancel: function() { /* cancel handler */ },
        error: function(error) { /* error handler */ }
      }
      OneDrive.open(odOptions);
    }
  </script>
  <button onClick="launchOneDrivePicker()">Open from OneDrive</button>

  <pre id="content" style="white-space: pre-wrap;"></pre>

  <script src="uploadApi.js"></script>
  <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
  <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
</body>

</html>